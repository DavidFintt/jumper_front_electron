"use strict";const I=require("electron"),L=require("node:path"),hn=require("node:os"),cn=require("node:fs"),sn=require("child_process"),fn=require("crypto"),ln=require("node:child_process");var un={exports:{}},mn=un.exports,pn;function _n(){return pn||(pn=1,(function(E,q){(function(J,G){E.exports=G(sn,fn)})(mn,function(J,G){return(function(r){function s(e){if(n[e])return n[e].exports;var t=n[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,s),t.loaded=!0,t.exports}var n={};return s.m=r,s.c=n,s.p="",s(0)})([function(r,s,n){r.exports=n(34)},function(r,s,n){var e=n(29)("wks"),t=n(33),o=n(2).Symbol,c=typeof o=="function",i=r.exports=function(u){return e[u]||(e[u]=c&&o[u]||(c?o:t)("Symbol."+u))};i.store=e},function(r,s){var n=r.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=n)},function(r,s,n){var e=n(9);r.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(r,s,n){r.exports=!n(24)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(r,s,n){var e=n(12),t=n(17);r.exports=n(4)?function(o,c,i){return e.f(o,c,t(1,i))}:function(o,c,i){return o[c]=i,o}},function(r,s){var n=r.exports={version:"2.4.0"};typeof __e=="number"&&(__e=n)},function(r,s,n){var e=n(14);r.exports=function(t,o,c){if(e(t),o===void 0)return t;switch(c){case 1:return function(i){return t.call(o,i)};case 2:return function(i,u){return t.call(o,i,u)};case 3:return function(i,u,a){return t.call(o,i,u,a)}}return function(){return t.apply(o,arguments)}}},function(r,s){var n={}.hasOwnProperty;r.exports=function(e,t){return n.call(e,t)}},function(r,s){r.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},function(r,s){r.exports={}},function(r,s){var n={}.toString;r.exports=function(e){return n.call(e).slice(8,-1)}},function(r,s,n){var e=n(3),t=n(26),o=n(32),c=Object.defineProperty;s.f=n(4)?Object.defineProperty:function(i,u,a){if(e(i),u=o(u,!0),e(a),t)try{return c(i,u,a)}catch{}if("get"in a||"set"in a)throw TypeError("Accessors not supported!");return"value"in a&&(i[u]=a.value),i}},function(r,s,n){var e=n(42),t=n(15);r.exports=function(o){return e(t(o))}},function(r,s){r.exports=function(n){if(typeof n!="function")throw TypeError(n+" is not a function!");return n}},function(r,s){r.exports=function(n){if(n==null)throw TypeError("Can't call method on  "+n);return n}},function(r,s,n){var e=n(9),t=n(2).document,o=e(t)&&e(t.createElement);r.exports=function(c){return o?t.createElement(c):{}}},function(r,s){r.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(r,s,n){var e=n(12).f,t=n(8),o=n(1)("toStringTag");r.exports=function(c,i,u){c&&!t(c=u?c:c.prototype,o)&&e(c,o,{configurable:!0,value:i})}},function(r,s,n){var e=n(29)("keys"),t=n(33);r.exports=function(o){return e[o]||(e[o]=t(o))}},function(r,s){var n=Math.ceil,e=Math.floor;r.exports=function(t){return isNaN(t=+t)?0:(t>0?e:n)(t)}},function(r,s,n){var e=n(11),t=n(1)("toStringTag"),o=e((function(){return arguments})())=="Arguments",c=function(i,u){try{return i[u]}catch{}};r.exports=function(i){var u,a,f;return i===void 0?"Undefined":i===null?"Null":typeof(a=c(u=Object(i),t))=="string"?a:o?e(u):(f=e(u))=="Object"&&typeof u.callee=="function"?"Arguments":f}},function(r,s){r.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(r,s,n){var e=n(2),t=n(6),o=n(7),c=n(5),i="prototype",u=function(a,f,p){var h,_,w,k=a&u.F,x=a&u.G,m=a&u.S,g=a&u.P,O=a&u.B,v=a&u.W,j=x?t:t[f]||(t[f]={}),b=j[i],P=x?e:m?e[f]:(e[f]||{})[i];x&&(p=f);for(h in p)_=!k&&P&&P[h]!==void 0,_&&h in j||(w=_?P[h]:p[h],j[h]=x&&typeof P[h]!="function"?p[h]:O&&_?o(w,e):v&&P[h]==w?(function(T){var F=function(C,M,W){if(this instanceof T){switch(arguments.length){case 0:return new T;case 1:return new T(C);case 2:return new T(C,M)}return new T(C,M,W)}return T.apply(this,arguments)};return F[i]=T[i],F})(w):g&&typeof w=="function"?o(Function.call,w):w,g&&((j.virtual||(j.virtual={}))[h]=w,a&u.R&&b&&!b[h]&&c(b,h,w)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,r.exports=u},function(r,s){r.exports=function(n){try{return!!n()}catch{return!0}}},function(r,s,n){r.exports=n(2).document&&document.documentElement},function(r,s,n){r.exports=!n(4)&&!n(24)(function(){return Object.defineProperty(n(16)("div"),"a",{get:function(){return 7}}).a!=7})},function(r,s,n){var e=n(28),t=n(23),o=n(57),c=n(5),i=n(8),u=n(10),a=n(45),f=n(18),p=n(52),h=n(1)("iterator"),_=!([].keys&&"next"in[].keys()),w="@@iterator",k="keys",x="values",m=function(){return this};r.exports=function(g,O,v,j,b,P,T){a(v,O,j);var F,C,M,W=function(d){if(!_&&d in R)return R[d];switch(d){case k:return function(){return new v(this,d)};case x:return function(){return new v(this,d)}}return function(){return new v(this,d)}},Y=O+" Iterator",V=b==x,X=!1,R=g.prototype,B=R[h]||R[w]||b&&R[b],A=B||W(b),nn=b?V?W("entries"):A:void 0,l=O=="Array"&&R.entries||B;if(l&&(M=p(l.call(new g)),M!==Object.prototype&&(f(M,Y,!0),e||i(M,h)||c(M,h,m))),V&&B&&B.name!==x&&(X=!0,A=function(){return B.call(this)}),e&&!T||!_&&!X&&R[h]||c(R,h,A),u[O]=A,u[Y]=m,b)if(F={values:V?A:W(x),keys:P?A:W(k),entries:nn},T)for(C in F)C in R||o(R,C,F[C]);else t(t.P+t.F*(_||X),O,F);return F}},function(r,s){r.exports=!0},function(r,s,n){var e=n(2),t="__core-js_shared__",o=e[t]||(e[t]={});r.exports=function(c){return o[c]||(o[c]={})}},function(r,s,n){var e,t,o,c=n(7),i=n(41),u=n(25),a=n(16),f=n(2),p=f.process,h=f.setImmediate,_=f.clearImmediate,w=f.MessageChannel,k=0,x={},m="onreadystatechange",g=function(){var v=+this;if(x.hasOwnProperty(v)){var j=x[v];delete x[v],j()}},O=function(v){g.call(v.data)};h&&_||(h=function(v){for(var j=[],b=1;arguments.length>b;)j.push(arguments[b++]);return x[++k]=function(){i(typeof v=="function"?v:Function(v),j)},e(k),k},_=function(v){delete x[v]},n(11)(p)=="process"?e=function(v){p.nextTick(c(g,v,1))}:w?(t=new w,o=t.port2,t.port1.onmessage=O,e=c(o.postMessage,o,1)):f.addEventListener&&typeof postMessage=="function"&&!f.importScripts?(e=function(v){f.postMessage(v+"","*")},f.addEventListener("message",O,!1)):e=m in a("script")?function(v){u.appendChild(a("script"))[m]=function(){u.removeChild(this),g.call(v)}}:function(v){setTimeout(c(g,v,1),0)}),r.exports={set:h,clear:_}},function(r,s,n){var e=n(20),t=Math.min;r.exports=function(o){return o>0?t(e(o),9007199254740991):0}},function(r,s,n){var e=n(9);r.exports=function(t,o){if(!e(t))return t;var c,i;if(o&&typeof(c=t.toString)=="function"&&!e(i=c.call(t))||typeof(c=t.valueOf)=="function"&&!e(i=c.call(t))||!o&&typeof(c=t.toString)=="function"&&!e(i=c.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(r,s){var n=0,e=Math.random();r.exports=function(t){return"Symbol(".concat(t===void 0?"":t,")_",(++n+e).toString(36))}},function(r,s,n){function e(m){return m&&m.__esModule?m:{default:m}}function t(){return process.platform!=="win32"?"":process.arch==="ia32"&&process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"mixed":"native"}function o(m){return(0,h.createHash)("sha256").update(m).digest("hex")}function c(m){switch(w){case"darwin":return m.split("IOPlatformUUID")[1].split(`
`)[0].replace(/\=|\s+|\"/gi,"").toLowerCase();case"win32":return m.toString().split("REG_SZ")[1].replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"linux":return m.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();case"freebsd":return m.toString().replace(/\r+|\n+|\s+/gi,"").toLowerCase();default:throw new Error("Unsupported platform: "+process.platform)}}function i(m){var g=c((0,p.execSync)(x[w]).toString());return m?g:o(g)}function u(m){return new f.default(function(g,O){return(0,p.exec)(x[w],{},function(v,j,b){if(v)return O(new Error("Error while obtaining machine id: "+v.stack));var P=c(j.toString());return g(m?P:o(P))})})}Object.defineProperty(s,"__esModule",{value:!0});var a=n(35),f=e(a);s.machineIdSync=i,s.machineId=u;var p=n(70),h=n(71),_=process,w=_.platform,k={native:"%windir%\\System32",mixed:"%windir%\\sysnative\\cmd.exe /c %windir%\\System32"},x={darwin:"ioreg -rd1 -c IOPlatformExpertDevice",win32:k[t()]+"\\REG.exe QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",linux:"( cat /var/lib/dbus/machine-id /etc/machine-id 2> /dev/null || hostname ) | head -n 1 || :",freebsd:"kenv -q smbios.system.uuid || sysctl -n kern.hostuuid"}},function(r,s,n){r.exports={default:n(36),__esModule:!0}},function(r,s,n){n(66),n(68),n(69),n(67),r.exports=n(6).Promise},function(r,s){r.exports=function(){}},function(r,s){r.exports=function(n,e,t,o){if(!(n instanceof e)||o!==void 0&&o in n)throw TypeError(t+": incorrect invocation!");return n}},function(r,s,n){var e=n(13),t=n(31),o=n(62);r.exports=function(c){return function(i,u,a){var f,p=e(i),h=t(p.length),_=o(a,h);if(c&&u!=u){for(;h>_;)if(f=p[_++],f!=f)return!0}else for(;h>_;_++)if((c||_ in p)&&p[_]===u)return c||_||0;return!c&&-1}}},function(r,p,n){var e=n(7),t=n(44),o=n(43),c=n(3),i=n(31),u=n(64),a={},f={},p=r.exports=function(h,_,w,k,x){var m,g,O,v,j=x?function(){return h}:u(h),b=e(w,k,_?2:1),P=0;if(typeof j!="function")throw TypeError(h+" is not iterable!");if(o(j)){for(m=i(h.length);m>P;P++)if(v=_?b(c(g=h[P])[0],g[1]):b(h[P]),v===a||v===f)return v}else for(O=j.call(h);!(g=O.next()).done;)if(v=t(O,b,g.value,_),v===a||v===f)return v};p.BREAK=a,p.RETURN=f},function(r,s){r.exports=function(n,e,t){var o=t===void 0;switch(e.length){case 0:return o?n():n.call(t);case 1:return o?n(e[0]):n.call(t,e[0]);case 2:return o?n(e[0],e[1]):n.call(t,e[0],e[1]);case 3:return o?n(e[0],e[1],e[2]):n.call(t,e[0],e[1],e[2]);case 4:return o?n(e[0],e[1],e[2],e[3]):n.call(t,e[0],e[1],e[2],e[3])}return n.apply(t,e)}},function(r,s,n){var e=n(11);r.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return e(t)=="String"?t.split(""):Object(t)}},function(r,s,n){var e=n(10),t=n(1)("iterator"),o=Array.prototype;r.exports=function(c){return c!==void 0&&(e.Array===c||o[t]===c)}},function(r,s,n){var e=n(3);r.exports=function(t,o,c,i){try{return i?o(e(c)[0],c[1]):o(c)}catch(a){var u=t.return;throw u!==void 0&&e(u.call(t)),a}}},function(r,s,n){var e=n(49),t=n(17),o=n(18),c={};n(5)(c,n(1)("iterator"),function(){return this}),r.exports=function(i,u,a){i.prototype=e(c,{next:t(1,a)}),o(i,u+" Iterator")}},function(r,s,n){var e=n(1)("iterator"),t=!1;try{var o=[7][e]();o.return=function(){t=!0},Array.from(o,function(){throw 2})}catch{}r.exports=function(c,i){if(!i&&!t)return!1;var u=!1;try{var a=[7],f=a[e]();f.next=function(){return{done:u=!0}},a[e]=function(){return f},c(a)}catch{}return u}},function(r,s){r.exports=function(n,e){return{value:e,done:!!n}}},function(r,s,n){var e=n(2),t=n(30).set,o=e.MutationObserver||e.WebKitMutationObserver,c=e.process,i=e.Promise,u=n(11)(c)=="process";r.exports=function(){var a,f,p,h=function(){var x,m;for(u&&(x=c.domain)&&x.exit();a;){m=a.fn,a=a.next;try{m()}catch(g){throw a?p():f=void 0,g}}f=void 0,x&&x.enter()};if(u)p=function(){c.nextTick(h)};else if(o){var _=!0,w=document.createTextNode("");new o(h).observe(w,{characterData:!0}),p=function(){w.data=_=!_}}else if(i&&i.resolve){var k=i.resolve();p=function(){k.then(h)}}else p=function(){t.call(e,h)};return function(x){var m={fn:x,next:void 0};f&&(f.next=m),a||(a=m,p()),f=m}}},function(r,s,n){var e=n(3),t=n(50),o=n(22),c=n(19)("IE_PROTO"),i=function(){},u="prototype",a=function(){var f,p=n(16)("iframe"),h=o.length,_=">";for(p.style.display="none",n(25).appendChild(p),p.src="javascript:",f=p.contentWindow.document,f.open(),f.write("<script>document.F=Object<\/script"+_),f.close(),a=f.F;h--;)delete a[u][o[h]];return a()};r.exports=Object.create||function(f,p){var h;return f!==null?(i[u]=e(f),h=new i,i[u]=null,h[c]=f):h=a(),p===void 0?h:t(h,p)}},function(r,s,n){var e=n(12),t=n(3),o=n(54);r.exports=n(4)?Object.defineProperties:function(c,i){t(c);for(var u,a=o(i),f=a.length,p=0;f>p;)e.f(c,u=a[p++],i[u]);return c}},function(r,s,n){var e=n(55),t=n(17),o=n(13),c=n(32),i=n(8),u=n(26),a=Object.getOwnPropertyDescriptor;s.f=n(4)?a:function(f,p){if(f=o(f),p=c(p,!0),u)try{return a(f,p)}catch{}if(i(f,p))return t(!e.f.call(f,p),f[p])}},function(r,s,n){var e=n(8),t=n(63),o=n(19)("IE_PROTO"),c=Object.prototype;r.exports=Object.getPrototypeOf||function(i){return i=t(i),e(i,o)?i[o]:typeof i.constructor=="function"&&i instanceof i.constructor?i.constructor.prototype:i instanceof Object?c:null}},function(r,s,n){var e=n(8),t=n(13),o=n(39)(!1),c=n(19)("IE_PROTO");r.exports=function(i,u){var a,f=t(i),p=0,h=[];for(a in f)a!=c&&e(f,a)&&h.push(a);for(;u.length>p;)e(f,a=u[p++])&&(~o(h,a)||h.push(a));return h}},function(r,s,n){var e=n(53),t=n(22);r.exports=Object.keys||function(o){return e(o,t)}},function(r,s){s.f={}.propertyIsEnumerable},function(r,s,n){var e=n(5);r.exports=function(t,o,c){for(var i in o)c&&t[i]?t[i]=o[i]:e(t,i,o[i]);return t}},function(r,s,n){r.exports=n(5)},function(r,s,n){var e=n(9),t=n(3),o=function(c,i){if(t(c),!e(i)&&i!==null)throw TypeError(i+": can't set as prototype!")};r.exports={set:Object.setPrototypeOf||("__proto__"in{}?(function(c,i,u){try{u=n(7)(Function.call,n(51).f(Object.prototype,"__proto__").set,2),u(c,[]),i=!(c instanceof Array)}catch{i=!0}return function(a,f){return o(a,f),i?a.__proto__=f:u(a,f),a}})({},!1):void 0),check:o}},function(r,s,n){var e=n(2),t=n(6),o=n(12),c=n(4),i=n(1)("species");r.exports=function(u){var a=typeof t[u]=="function"?t[u]:e[u];c&&a&&!a[i]&&o.f(a,i,{configurable:!0,get:function(){return this}})}},function(r,s,n){var e=n(3),t=n(14),o=n(1)("species");r.exports=function(c,i){var u,a=e(c).constructor;return a===void 0||(u=e(a)[o])==null?i:t(u)}},function(r,s,n){var e=n(20),t=n(15);r.exports=function(o){return function(c,i){var u,a,f=String(t(c)),p=e(i),h=f.length;return p<0||p>=h?o?"":void 0:(u=f.charCodeAt(p),u<55296||u>56319||p+1===h||(a=f.charCodeAt(p+1))<56320||a>57343?o?f.charAt(p):u:o?f.slice(p,p+2):(u-55296<<10)+(a-56320)+65536)}}},function(r,s,n){var e=n(20),t=Math.max,o=Math.min;r.exports=function(c,i){return c=e(c),c<0?t(c+i,0):o(c,i)}},function(r,s,n){var e=n(15);r.exports=function(t){return Object(e(t))}},function(r,s,n){var e=n(21),t=n(1)("iterator"),o=n(10);r.exports=n(6).getIteratorMethod=function(c){if(c!=null)return c[t]||c["@@iterator"]||o[e(c)]}},function(r,s,n){var e=n(37),t=n(47),o=n(10),c=n(13);r.exports=n(27)(Array,"Array",function(i,u){this._t=c(i),this._i=0,this._k=u},function(){var i=this._t,u=this._k,a=this._i++;return!i||a>=i.length?(this._t=void 0,t(1)):u=="keys"?t(0,a):u=="values"?t(0,i[a]):t(0,[a,i[a]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(r,s){},function(r,s,n){var e,t,o,c=n(28),i=n(2),u=n(7),a=n(21),f=n(23),p=n(9),h=(n(3),n(14)),_=n(38),w=n(40),k=(n(58).set,n(60)),x=n(30).set,m=n(48)(),g="Promise",O=i.TypeError,j=i.process,v=i[g],j=i.process,b=a(j)=="process",P=function(){},T=!!(function(){try{var l=v.resolve(1),d=(l.constructor={})[n(1)("species")]=function(y){y(P,P)};return(b||typeof PromiseRejectionEvent=="function")&&l.then(P)instanceof d}catch{}})(),F=function(l,d){return l===d||l===v&&d===o},C=function(l){var d;return!(!p(l)||typeof(d=l.then)!="function")&&d},M=function(l){return F(v,l)?new W(l):new t(l)},W=t=function(l){var d,y;this.promise=new l(function(S,D){if(d!==void 0||y!==void 0)throw O("Bad Promise constructor");d=S,y=D}),this.resolve=h(d),this.reject=h(y)},Y=function(l){try{l()}catch(d){return{error:d}}},V=function(l,d){if(!l._n){l._n=!0;var y=l._c;m(function(){for(var S=l._v,D=l._s==1,z=0,Q=function(H){var U,rn,en=D?H.ok:H.fail,tn=H.resolve,Z=H.reject,on=H.domain;try{en?(D||(l._h==2&&B(l),l._h=1),en===!0?U=S:(on&&on.enter(),U=en(S),on&&on.exit()),U===H.promise?Z(O("Promise-chain cycle")):(rn=C(U))?rn.call(U,tn,Z):tn(U)):Z(S)}catch(yn){Z(yn)}};y.length>z;)Q(y[z++]);l._c=[],l._n=!1,d&&!l._h&&X(l)})}},X=function(l){x.call(i,function(){var d,y,S,D=l._v;if(R(l)&&(d=Y(function(){b?j.emit("unhandledRejection",D,l):(y=i.onunhandledrejection)?y({promise:l,reason:D}):(S=i.console)&&S.error&&S.error("Unhandled promise rejection",D)}),l._h=b||R(l)?2:1),l._a=void 0,d)throw d.error})},R=function(l){if(l._h==1)return!1;for(var d,y=l._a||l._c,S=0;y.length>S;)if(d=y[S++],d.fail||!R(d.promise))return!1;return!0},B=function(l){x.call(i,function(){var d;b?j.emit("rejectionHandled",l):(d=i.onrejectionhandled)&&d({promise:l,reason:l._v})})},A=function(l){var d=this;d._d||(d._d=!0,d=d._w||d,d._v=l,d._s=2,d._a||(d._a=d._c.slice()),V(d,!0))},nn=function(l){var d,y=this;if(!y._d){y._d=!0,y=y._w||y;try{if(y===l)throw O("Promise can't be resolved itself");(d=C(l))?m(function(){var S={_w:y,_d:!1};try{d.call(l,u(nn,S,1),u(A,S,1))}catch(D){A.call(S,D)}}):(y._v=l,y._s=1,V(y,!1))}catch(S){A.call({_w:y,_d:!1},S)}}};T||(v=function(l){_(this,v,g,"_h"),h(l),e.call(this);try{l(u(nn,this,1),u(A,this,1))}catch(d){A.call(this,d)}},e=function(l){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=n(56)(v.prototype,{then:function(l,d){var y=M(k(this,v));return y.ok=typeof l!="function"||l,y.fail=typeof d=="function"&&d,y.domain=b?j.domain:void 0,this._c.push(y),this._a&&this._a.push(y),this._s&&V(this,!1),y.promise},catch:function(l){return this.then(void 0,l)}}),W=function(){var l=new e;this.promise=l,this.resolve=u(nn,l,1),this.reject=u(A,l,1)}),f(f.G+f.W+f.F*!T,{Promise:v}),n(18)(v,g),n(59)(g),o=n(6)[g],f(f.S+f.F*!T,g,{reject:function(l){var d=M(this),y=d.reject;return y(l),d.promise}}),f(f.S+f.F*(c||!T),g,{resolve:function(l){if(l instanceof v&&F(l.constructor,this))return l;var d=M(this),y=d.resolve;return y(l),d.promise}}),f(f.S+f.F*!(T&&n(46)(function(l){v.all(l).catch(P)})),g,{all:function(l){var d=this,y=M(d),S=y.resolve,D=y.reject,z=Y(function(){var Q=[],H=0,U=1;w(l,!1,function(rn){var en=H++,tn=!1;Q.push(void 0),U++,d.resolve(rn).then(function(Z){tn||(tn=!0,Q[en]=Z,--U||S(Q))},D)}),--U||S(Q)});return z&&D(z.error),y.promise},race:function(l){var d=this,y=M(d),S=y.reject,D=Y(function(){w(l,!1,function(z){d.resolve(z).then(y.resolve,S)})});return D&&S(D.error),y.promise}})},function(r,s,n){var e=n(61)(!0);n(27)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,o=this._t,c=this._i;return c>=o.length?{value:void 0,done:!0}:(t=e(o,c),this._i+=t.length,{value:t,done:!1})})},function(r,s,n){n(65);for(var e=n(2),t=n(5),o=n(10),c=n(1)("toStringTag"),i=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],u=0;u<5;u++){var a=i[u],f=e[a],p=f&&f.prototype;p&&!p[c]&&t(p,c,a),o[a]=o.Array}},function(r,s){r.exports=sn},function(r,s){r.exports=fn}])})})(un)),un.exports}var gn=_n();const dn=!I.app.isPackaged;let K=null,N=null;const an=L.join(I.app.getPath("userData"),"logs"),xn=L.join(an,"jump.log");function $(E){const q=`[${new Date().toISOString()}] ${E}
`;try{cn.existsSync(an)||cn.mkdirSync(an,{recursive:!0}),cn.appendFileSync(xn,q)}catch{}console.log(E)}function wn(){const E=process.platform==="win32"?"backend.exe":"backend";return I.app.isPackaged?L.join(process.resourcesPath,"backend",E):L.join(__dirname,"resources","backend",E)}function jn(E,q=120,J=500){return new Promise((G,r)=>{let s=0;const n=()=>{fetch(E).then(e=>{if($(`Health check tentativa ${s+1}: status ${e.status}`),e.ok)G();else throw new Error(`HTTP ${e.status}`)}).catch(e=>{s++,s%10===0&&$(`Ainda aguardando Django... tentativa ${s} — ${e.message}`),s<q?setTimeout(n,J):r(new Error(`Django não respondeu após ${s} tentativas. Último erro: ${e.message}`))})};n()})}function bn(){const E=wn(),q=L.dirname(E);$(`Django bin: ${E}`),$(`Django dir: ${q}`),$(`Bin exists: ${cn.existsSync(E)}`);const J=L.join(I.app.getPath("userData"),"jump.db"),G={...process.env,PYTHONUNBUFFERED:"1",DB_PATH:J};ln.spawn(E,["migrate","--run-syncdb"],{cwd:q,env:G}).on("exit",s=>{$(`Migrate exited with code: ${s}`),N=ln.spawn(E,["runserver","127.0.0.1:8000","--noreload"],{cwd:q,env:G}),N.stdout?.on("data",n=>{$(`Django stdout: ${n}`)}),N.stderr?.on("data",n=>{$(`Django stderr: ${n}`)}),N.on("error",n=>{$(`Django spawn error: ${n}`)}),N.on("exit",(n,e)=>{$(`Django exited — code: ${n}, signal: ${e}`)}),$("Django process setup complete")})}I.ipcMain.handle("get-machine-id",()=>{try{return gn.machineIdSync()}catch{return`fallback-${hn.hostname()}-${Date.now()}`}});I.ipcMain.handle("get-machine-name",()=>hn.hostname());async function vn(){const E=dn?L.join(__dirname,"../public/logo.ico"):L.join(process.resourcesPath,"logo.ico");K=new I.BrowserWindow({width:1024,height:768,icon:E,webPreferences:{preload:L.join(__dirname,"preload.js")}});try{await jn("http://127.0.0.1:8000/api/health/"),dn&&process.env.VITE_DEV_SERVER_URL?K.loadURL(process.env.VITE_DEV_SERVER_URL):K.loadFile(L.join(__dirname,"../dist/index.html")),K.webContents.openDevTools()}catch(q){$(`Django não iniciou: ${q}`),K.loadFile(L.join(__dirname,"../dist/error.html"))}K.on("closed",()=>{K=null})}I.app.on("ready",()=>{bn(),vn()});I.app.on("will-quit",()=>{if(N&&(N.kill(),N=null),process.platform==="win32")try{require("child_process").execSync("taskkill /F /IM backend.exe /T",{stdio:"ignore"})}catch(E){$(`Erro ao finalizar backend.exe: ${E}`)}else try{require("child_process").execSync("pkill -f backend",{stdio:"ignore"})}catch(E){$(`Erro ao finalizar processo backend: ${E}`)}});I.app.on("window-all-closed",()=>{process.platform!=="darwin"&&I.app.quit()});I.app.on("activate",()=>{I.BrowserWindow.getAllWindows().length===0&&vn()});
